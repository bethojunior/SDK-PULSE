{"version":3,"sources":["../src/core.js"],"names":[],"mappings":"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","file":"chunk-ILHWV3SH.js","sourcesContent":["class PulseCore {\n  #endpoint = 'https://injest-pulse.704app.com.br/logs'\n  #app\n  #groupId\n  #initialized = false\n\n  /* =======================\n   * INIT\n   * ======================= */\n  init(config) {\n    if (this.#initialized) return\n\n    this.#app = config.app\n    this.#groupId = config.groupId\n\n    if (typeof window === 'undefined') {\n      this.#listenNodeErrors()\n      console.log('[Pulse] ✅ Inicializado para Node.js')\n    } else {\n      this.#listenBrowserErrors()\n      console.log('[Pulse] ✅ Inicializado para Browser')\n    }\n\n    this.#interceptConsole()\n    this.#initialized = true\n    console.log(`[Pulse] Configurado: app=\"${this.#app}\", groupId=\"${this.#groupId}\"`)\n  }\n\n  initFromEnv() {\n    if (typeof process === 'undefined') return\n\n    const app = process.env.PULSE_APP\n    const groupId = process.env.PULSE_GROUP\n\n    if (!app || !groupId) return\n\n    this.init({ app, groupId })\n  }\n\n  /* =======================\n   * PUBLIC MANUAL LOG\n   * ======================= */\n  emergency(error, context = 'manual.emergency') {\n    this.#send('emergency', error, context)\n  }\n\n  /* =======================\n   * CORE SEND\n   * ======================= */\n  #send(type, error, context) {\n    if (!this.#app || !this.#groupId) {\n      console.warn('[Pulse] Não inicializado. Chame Pulse.init() primeiro.')\n      return\n    }\n\n    // Normalizar o erro para obter informações detalhadas\n    const normalizedError = this.#normalizeError(error)\n    \n    // Contexto SEMPRE deve ser o stack do erro, nunca nulo\n    let errorContext = normalizedError.stack || ''\n    \n    // Se não houver stack, criar um contexto baseado no erro\n    if (!errorContext) {\n      if (normalizedError.name && normalizedError.message) {\n        errorContext = `${normalizedError.name}: ${normalizedError.message}`\n      } else if (normalizedError.message) {\n        errorContext = normalizedError.message\n      } else {\n        errorContext = String(error)\n      }\n    }\n    \n    // Construir mensagem precisa com informações do erro\n    let messageParts = []\n    \n    // Adicionar tipo de erro e nome se disponível\n    if (normalizedError.name) {\n      messageParts.push(`Error: ${normalizedError.name}`)\n    }\n    \n    // Adicionar mensagem do erro\n    if (normalizedError.message) {\n      messageParts.push(`Message: ${normalizedError.message}`)\n    } else {\n      messageParts.push(`Message: ${String(error)}`)\n    }\n    \n    // Adicionar contexto original se fornecido (apenas como informação adicional)\n    if (context) {\n      messageParts.push(`Source: ${context}`)\n    }\n    \n    // Construir mensagem final\n    let message = messageParts.join('\\n')\n    \n    // Incluir stack na mensagem se disponível\n    if (normalizedError.stack) {\n      message = `${message}\\n\\nStack Trace:\\n${normalizedError.stack}`\n    }\n\n    // Formato esperado pela API - contexto SEMPRE será o stack (nunca nulo)\n    const payload = {\n      type,\n      groupId: this.#groupId,\n      app: this.#app,\n      message,\n      context: errorContext // SEMPRE preenchido com stack ou fallback\n    }\n    \n    // Garantir que context nunca seja nulo ou vazio\n    if (!payload.context || payload.context.trim() === '') {\n      payload.context = 'No stack trace available'\n    }\n\n    console.log(`[Pulse] Enviando log: ${type} - ${context || 'sem contexto'}`)\n\n    fetch(this.#endpoint, {\n      method: 'POST',\n      headers: { 'Content-Type': 'application/json' },\n      body: JSON.stringify(payload)\n    })\n      .then(async (response) => {\n        if (response.ok) {\n          console.log(`[Pulse] ✅ Log enviado com sucesso: ${type} - ${context || 'sem contexto'}`)\n        } else {\n          const errorText = await response.text().catch(() => '')\n          console.error(`[Pulse] ❌ Erro ao enviar log: ${response.status} ${response.statusText}`)\n          console.error(`[Pulse] Resposta: ${errorText}`)\n        }\n      })\n      .catch((err) => {\n        console.error('[Pulse] ❌ Erro na requisição:', err.message)\n      })\n  }\n\n  #normalizeError(error) {\n    if (error instanceof Error) {\n      return {\n        message: error.message,\n        name: error.name,\n        stack: error.stack\n      }\n    }\n\n    // Se for um array (como do console.error), processar cada item\n    if (Array.isArray(error)) {\n      const messages = error.map(item => {\n        if (item instanceof Error) {\n          return `[${item.name}] ${item.message}${item.stack ? '\\n' + item.stack : ''}`\n        }\n        if (typeof item === 'object' && item !== null) {\n          try {\n            return JSON.stringify(item, null, 2)\n          } catch {\n            return String(item)\n          }\n        }\n        return String(item)\n      })\n      return {\n        message: messages.join(' '),\n        name: 'MultipleErrors',\n        stack: null\n      }\n    }\n\n    if (typeof error === 'object' && error !== null) {\n      try {\n        const stringified = JSON.stringify(error, null, 2)\n        return { \n          message: stringified,\n          name: error.constructor?.name || 'Object',\n          stack: null\n        }\n      } catch {\n        return { \n          message: '[Unserializable object]',\n          name: 'Unserializable',\n          stack: null\n        }\n      }\n    }\n\n    return { \n      message: String(error),\n      name: typeof error,\n      stack: null\n    }\n  }\n\n  /* =======================\n   * NODE HANDLERS\n   * ======================= */\n  #listenNodeErrors() {\n    console.log('[Pulse] Registrando handlers de erro do Node.js...')\n    \n    process.on('uncaughtException', (error) => {\n      console.error('[Pulse] ⚠️  Capturando uncaughtException:', error.message)\n      this.#send('critical', error, 'uncaughtException')\n      // Não encerra o processo imediatamente para dar tempo de enviar o log\n      setTimeout(() => {\n        process.exit(1)\n      }, 2000)\n    })\n\n    process.on('unhandledRejection', (reason, promise) => {\n      const errorMessage = reason instanceof Error ? reason.message : String(reason)\n      console.error('[Pulse] ⚠️  Capturando unhandledRejection:', errorMessage)\n      this.#send('critical', reason, 'unhandledRejection')\n    })\n    \n    // Garantir que avisos de unhandledRejection sejam mostrados\n    process.on('warning', (warning) => {\n      if (warning.name === 'UnhandledPromiseRejectionWarning') {\n        console.warn('[Pulse] Aviso de Promise rejeitada detectado')\n      }\n    })\n  }\n\n  /* =======================\n   * BROWSER HANDLERS\n   * ======================= */\n  #listenBrowserErrors() {\n    window.addEventListener('error', (event) => {\n      this.#send('critical', event.error ?? event.message, 'window.error')\n    })\n\n    window.addEventListener('unhandledrejection', (event) => {\n      this.#send('critical', event.reason, 'unhandledRejection')\n    })\n  }\n\n  /* =======================\n   * CONSOLE INTERCEPT\n   * ======================= */\n  #interceptConsole() {\n    const original = console.error.bind(console)\n    let isSending = false // Flag para evitar loops infinitos\n\n    console.error = (...args) => {\n      // Evitar loop infinito se o próprio send gerar um console.error\n      if (!isSending) {\n        isSending = true\n        try {\n          // Encontrar o primeiro Error nos argumentos, se houver\n          let errorToSend = null\n          for (const arg of args) {\n            if (arg instanceof Error) {\n              errorToSend = arg\n              break\n            }\n          }\n          \n          // Se não encontrou Error, criar um com a mensagem\n          if (!errorToSend) {\n            const message = args\n              .map(arg => {\n                if (typeof arg === 'object' && arg !== null) {\n                  try {\n                    return JSON.stringify(arg)\n                  } catch {\n                    return String(arg)\n                  }\n                }\n                return String(arg)\n              })\n              .join(' ')\n            errorToSend = new Error(message)\n            // Adicionar stack trace artificial\n            Error.captureStackTrace?.(errorToSend, console.error)\n          }\n          \n          this.#send('error', errorToSend, 'console.error')\n        } catch (err) {\n          // Se der erro ao enviar, apenas logar sem interceptar novamente\n          original('[Pulse] Erro ao interceptar console.error:', err)\n        } finally {\n          isSending = false\n        }\n      }\n      \n      // Sempre chamar o console.error original\n      original(...args)\n    }\n  }\n}\n\nexport const Pulse = new PulseCore()\n"]}